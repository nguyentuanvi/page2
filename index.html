<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>The Healing Words</title> <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin: 0;
        background: url('293562-follow-your-own-light-sunset-wallpaper-beach-sunset-wallpaper.jpg');
        background-size: cover;
        min-height: 100vh;
        /* Thay đổi màu chữ mặc định cho toàn bộ trang */
        color: #f0f0f0; /* Ví dụ: màu xám nhạt cho chữ trên nền tối */
        /* Thay đổi cỡ chữ mặc định cho toàn bộ trang */
        font-size: 16px; /* Ví dụ: cỡ chữ cơ bản 16px */
        display: flex;
        flex-direction: column;
        align-items: center; /* Căn giữa theo chiều ngang */
        justify-content: center; /* THAY ĐỔI MỚI: Căn giữa theo chiều dọc */
      }

      /* .header-image không còn được sử dụng trong HTML, có thể xóa nếu không cần */
      /* .header-image {
        width: 100%;
        max-height: 250px;
        object-fit: cover;
      } */

      h1 {
        margin: 16px 0 10px;
        /* Thay đổi cỡ chữ cho tiêu đề chính */
        font-size: 28px; /* Ví dụ: 28px */
        font-weight: bold;
        /* Thay đổi màu chữ cho tiêu đề chính */
        color: #ffffff; /* Ví dụ: màu trắng */
      }

      h2 {
        /* Thay đổi cỡ chữ cho tiêu đề phụ "READ ME WHEN" */
        font-size: 22px; /* Ví dụ: 22px */
        margin-bottom: 12px;
        /* Thay đổi màu chữ cho tiêu đề phụ */
        color: #ffffff; /* Ví dụ: màu vàng */
      }

      #verse {
        margin: 16px;
        font-style: italic;
        /* Thay đổi cỡ chữ cho câu trích dẫn/Kinh thánh */
        font-size: 18px; /* Ví dụ: 24px */
        max-width: 90%;
        background: rgba(255, 255, 255, 0.7);
        padding: 12px;
        border-radius: 10px;
        /* Thay đổi màu chữ cho câu trích dẫn/Kinh thánh */
        color: #ffffff; /* Ví dụ: màu xanh đậm */
      }

      .mood-buttons {
        display: flex;
        flex-wrap: wrap;
        justify-content: center;
        gap: 10px;
        max-width: 400px;
        margin-bottom: 40px;
      }

      .btn {
        padding: 12px 16px;
        border: none;
        border-radius: 10px;
        /* Cỡ chữ cho các nút */
        font-size: 16px; /* Ví dụ: 16px */
        cursor: pointer;
        /* Màu chữ cho các nút */
        color: white; /* Giữ nguyên màu trắng hoặc thay đổi */
        min-width: 120px;
        transition: transform 0.2s ease-in-out; /* Add transition for hover effect */
      }

      .btn:hover {
        transform: translateY(-3px); /* Lift button on hover */
      }

      .happy,
      .angry,
      .thankful,
      .hopeful,
      .sad,
      .troubled {
        background-color: #f4c542; /* Màu nền của nút */
        color: #000; /* Màu chữ của nút (hiện đang là đen) */
      }

      /* Highlight button style */
      .selected {
        border: 2px solid #ffffff;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
      }
    </style>
  </head>
  <body>
    <h1>The Healing Words</h1>

    <div id="verse">Loading verses...</div>
    <h2>READ ME WHEN</h2>
    <div class="mood-buttons">
      <button class="btn happy" data-emotion="happy">Happy</button>
      <button class="btn sad" data-emotion="sad">Sad</button>
      <button class="btn angry" data-emotion="angry">Angry</button>
      <button class="btn thankful" data-emotion="thankful">Thankful</button>
      <button class="btn hopeful" data-emotion="hopeful">Hopeful</button>
      <button class="btn troubled" data-emotion="troubled">Troubled</button>
    </div>

    <script>
      const SHEET_ID = '1BMBjTkjPA5KhpbZKWN3HctUeK8Z0A0G2pP4XX49wLdo';
      const GID = '725867898';
      const SHEET_URL = `https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&tq=SELECT%20A%2C%20B%2C%20C%2C%20D%2C%20E%2C%20F&gid=${GID}`;

      let versesData = {
        happy: [],
        sad: [],
        angry: [],
        thankful: [],
        hopeful: [],
        troubled: [],
      };

      const emotionColumnMap = {
        happy: 0, // Cột A
        sad: 1, // Cột B
        angry: 2, // Cột C
        thankful: 3, // Cột D
        hopeful: 4, // Cột E
        troubled: 5, // Cột F
      };

      const verseDisplay = document.getElementById('verse');
      const buttons = document.querySelectorAll('.mood-buttons .btn');

      async function fetchVerses() {
        verseDisplay.textContent = "Loading verses...";
        try {
          const response = await fetch(SHEET_URL);
          const text = await response.text();
          const jsonString = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
          const data = JSON.parse(jsonString);

          const rows = data.table.rows.slice(1);

          rows.forEach(row => {
            for (const emotion in emotionColumnMap) {
              const colIndex = emotionColumnMap[emotion];
              if (row.c[colIndex] && row.c[colIndex].v) {
                versesData[emotion].push(row.c[colIndex].v);
              }
            }
          });
          console.log("Verses loaded:", versesData);
          showVerse('happy');
          document.querySelector('.happy').classList.add('selected');

        } catch (error) {
          console.error("Error fetching verses:", error);
          verseDisplay.textContent = "Failed to load verses. Please check your sheet ID, column selection, and network connection.";
        }
      }

      function showVerse(emotion) {
        const pool = versesData[emotion];
        if (pool && pool.length > 0) {
          const random = pool[Math.floor(Math.random() * pool.length)];
          verseDisplay.textContent = random;
        } else {
          verseDisplay.textContent = `No verses available for ${emotion}.`;
        }

        buttons.forEach((button) => button.classList.remove('selected'));

        const selectedButton = document.querySelector(`.btn[data-emotion="${emotion}"]`);
        if (selectedButton) {
          selectedButton.classList.add('selected');
        }
      }

      buttons.forEach(button => {
        button.addEventListener('click', (event) => {
          const emotion = event.target.dataset.emotion;
          showVerse(emotion);
        });
      });

      fetchVerses();
    </script>
  </body>
</html>
